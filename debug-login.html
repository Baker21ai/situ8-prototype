<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Debug Login</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        button { margin: 5px; padding: 10px; }
        #output { background: #f0f0f0; padding: 10px; margin: 20px 0; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>Debug Login System</h1>
    
    <div>
        <button onclick="clearStorage()">Clear Storage</button>
        <button onclick="goToApp()">Go to App</button>
    </div>
    
    <div id="output"></div>
    
    <script>
        function log(msg, type = '') {
            const output = document.getElementById('output');
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : '';
            output.innerHTML += `<div class="${className}">${new Date().toLocaleTimeString()} - ${msg}</div>`;
        }
        
        function clearStorage() {
            localStorage.clear();
            sessionStorage.clear();
            
            // Clear all cookies
            document.cookie.split(";").forEach(function(c) { 
                document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
            });
            
            log('Cleared all storage', 'success');
        }
        
        function goToApp() {
            log('Redirecting to app...');
            window.location.href = 'http://localhost:5173';
        }
        
        // Check current state
        window.onload = function() {
            log('Checking current state...');
            
            const authSession = localStorage.getItem('situ8_auth_session');
            if (authSession) {
                try {
                    const session = JSON.parse(authSession);
                    log(`Found session for: ${session.user?.email || 'unknown'}`);
                    log(`Demo mode: ${session.isDemoMode}`);
                } catch (e) {
                    log('Invalid session data', 'error');
                }
            } else {
                log('No session found');
            }
            
            // Check for Amplify tokens
            const ampKeys = Object.keys(localStorage).filter(k => k.includes('aws-amplify'));
            if (ampKeys.length > 0) {
                log(`Found ${ampKeys.length} Amplify keys`);
            }
        };
    </script>
</body>
</html>