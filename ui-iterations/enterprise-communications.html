<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Situ8 Communications Hub - Enterprise Edition</title>
    <style>
        /* CSS Reset & Variables */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Enterprise Dark Theme - Optimized for 24/7 Operations */
            --bg-primary: #0a0a0a;
            --bg-secondary: #0f0f0f;
            --bg-tertiary: #141414;
            --bg-elevated: #1a1a1a;
            --bg-interactive: #1f1f1f;
            --bg-hover: #242424;
            --bg-active: #2a2a2a;
            
            /* Text Hierarchy */
            --text-primary: #f5f5f5;
            --text-secondary: #b8b8b8;
            --text-tertiary: #808080;
            --text-quaternary: #5a5a5a;
            
            /* Accent Colors - Precision Calibrated */
            --accent-primary: #0066ff;
            --accent-secondary: #00a6ff;
            --accent-success: #00d68f;
            --accent-warning: #ffaa00;
            --accent-danger: #ff3366;
            --accent-info: #00b8d4;
            
            /* Communication Channels */
            --channel-radio: #8b5cf6;
            --channel-phone: #3b82f6;
            --channel-text: #10b981;
            --channel-email: #f59e0b;
            --channel-video: #ef4444;
            --channel-emergency: #dc2626;
            
            /* Semantic Colors */
            --border-subtle: rgba(255, 255, 255, 0.06);
            --border-default: rgba(255, 255, 255, 0.1);
            --border-strong: rgba(255, 255, 255, 0.2);
            
            /* ML/AI Indicators */
            --ml-positive: #22c55e;
            --ml-negative: #ef4444;
            --ml-neutral: #6b7280;
            --ml-processing: #3b82f6;
            
            /* Spacing System */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            
            /* Typography */
            --font-mono: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
            --font-sans: -apple-system, BlinkMacSystemFont, 'Inter', sans-serif;
            
            /* Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Z-Index Layers */
            --z-base: 1;
            --z-elevated: 10;
            --z-overlay: 100;
            --z-modal: 1000;
            --z-notification: 10000;
        }

        /* Base Styles */
        body {
            font-family: var(--font-sans);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 13px;
            line-height: 1.5;
            height: 100vh;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Main Layout Grid */
        .app-container {
            display: grid;
            grid-template-columns: 240px 320px 1fr 360px;
            grid-template-rows: 56px 1fr 64px;
            height: 100vh;
            gap: 1px;
            background: var(--border-subtle);
        }

        /* Header */
        .header {
            grid-column: 1 / -1;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-default);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--space-lg);
            z-index: var(--z-elevated);
        }

        .header-brand {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .header-title {
            font-size: 16px;
            font-weight: 600;
            letter-spacing: -0.02em;
        }

        .header-subtitle {
            color: var(--text-tertiary);
            font-size: 12px;
        }

        .header-stats {
            display: flex;
            gap: var(--space-xl);
            align-items: center;
        }

        .stat-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 600;
            font-variant-numeric: tabular-nums;
        }

        .stat-label {
            font-size: 10px;
            text-transform: uppercase;
            color: var(--text-tertiary);
            letter-spacing: 0.05em;
        }

        .stat-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-left: var(--space-xs);
            display: inline-block;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Channel Sidebar */
        .channel-sidebar {
            background: var(--bg-secondary);
            overflow-y: auto;
            overflow-x: hidden;
        }

        .channel-section {
            padding: var(--space-md);
        }

        .channel-section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-sm);
        }

        .channel-section-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-tertiary);
            letter-spacing: 0.05em;
        }

        .channel-item {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            margin: 2px 0;
            border-radius: 6px;
            cursor: pointer;
            transition: all var(--transition-fast);
            position: relative;
        }

        .channel-item:hover {
            background: var(--bg-hover);
        }

        .channel-item.active {
            background: var(--bg-active);
            color: var(--text-primary);
        }

        .channel-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            font-size: 16px;
            background: var(--bg-elevated);
            transition: all var(--transition-fast);
        }

        .channel-item.active .channel-icon {
            background: var(--accent-primary);
            color: white;
        }

        .channel-info {
            flex: 1;
            min-width: 0;
        }

        .channel-name {
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .channel-status {
            font-size: 11px;
            color: var(--text-tertiary);
        }

        .channel-badge {
            position: absolute;
            top: 6px;
            right: 6px;
            background: var(--accent-danger);
            color: white;
            font-size: 10px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }

        /* Message List */
        .message-list {
            background: var(--bg-tertiary);
            display: flex;
            flex-direction: column;
        }

        .message-list-header {
            padding: var(--space-md);
            border-bottom: 1px solid var(--border-default);
            flex-shrink: 0;
        }

        .message-filter {
            display: flex;
            gap: var(--space-sm);
        }

        .filter-chip {
            padding: var(--space-xs) var(--space-sm);
            background: var(--bg-elevated);
            border: 1px solid var(--border-default);
            border-radius: 16px;
            font-size: 11px;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .filter-chip:hover {
            background: var(--bg-hover);
        }

        .filter-chip.active {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .message-items {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-sm);
        }

        .message-item {
            background: var(--bg-elevated);
            border: 1px solid var(--border-default);
            border-radius: 8px;
            padding: var(--space-md);
            margin-bottom: var(--space-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
            position: relative;
            overflow: hidden;
        }

        .message-item:hover {
            background: var(--bg-hover);
            border-color: var(--border-strong);
            transform: translateX(2px);
        }

        .message-item.active {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 1px var(--accent-primary);
        }

        .message-priority {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
        }

        .message-priority.critical { background: var(--accent-danger); }
        .message-priority.high { background: var(--accent-warning); }
        .message-priority.medium { background: var(--accent-info); }
        .message-priority.low { background: var(--accent-success); }

        .message-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-xs);
        }

        .message-sender {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .message-channel-badge {
            width: 16px;
            height: 16px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }

        .message-time {
            font-size: 11px;
            color: var(--text-tertiary);
            font-variant-numeric: tabular-nums;
        }

        .message-preview {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .message-metadata {
            display: flex;
            gap: var(--space-md);
            margin-top: var(--space-sm);
            font-size: 11px;
            color: var(--text-tertiary);
        }

        .message-tag {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        /* Main Communication Area */
        .communication-main {
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
        }

        .communication-header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-default);
            padding: var(--space-md) var(--space-lg);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .communication-title {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .communication-actions {
            display: flex;
            gap: var(--space-sm);
        }

        .action-button {
            padding: var(--space-xs) var(--space-md);
            background: var(--bg-elevated);
            border: 1px solid var(--border-default);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 12px;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .action-button:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
            border-color: var(--border-strong);
        }

        .action-button.primary {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .action-button.danger {
            background: var(--accent-danger);
            color: white;
            border-color: var(--accent-danger);
        }

        /* Message Thread */
        .message-thread {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-lg);
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .thread-message {
            display: flex;
            gap: var(--space-md);
            animation: fadeIn var(--transition-base) ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .thread-avatar {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: var(--bg-elevated);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            flex-shrink: 0;
            border: 2px solid var(--border-default);
        }

        .thread-content {
            flex: 1;
            min-width: 0;
        }

        .thread-header {
            display: flex;
            align-items: baseline;
            gap: var(--space-sm);
            margin-bottom: var(--space-xs);
        }

        .thread-sender {
            font-weight: 600;
        }

        .thread-time {
            font-size: 11px;
            color: var(--text-tertiary);
        }

        .thread-body {
            background: var(--bg-elevated);
            border: 1px solid var(--border-default);
            border-radius: 8px;
            padding: var(--space-md);
            position: relative;
        }

        .thread-text {
            line-height: 1.6;
            white-space: pre-wrap;
        }

        .thread-attachments {
            display: flex;
            gap: var(--space-sm);
            margin-top: var(--space-md);
            flex-wrap: wrap;
        }

        .attachment {
            background: var(--bg-interactive);
            border: 1px solid var(--border-default);
            border-radius: 6px;
            padding: var(--space-sm) var(--space-md);
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .attachment:hover {
            background: var(--bg-hover);
            border-color: var(--border-strong);
        }

        /* ML Analysis Panel */
        .ml-panel {
            background: var(--bg-elevated);
            border: 1px solid var(--border-default);
            border-radius: 8px;
            padding: var(--space-md);
            margin-top: var(--space-sm);
        }

        .ml-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-md);
        }

        .ml-title {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .ml-indicator {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--ml-processing);
            animation: pulse 2s ease-in-out infinite;
        }

        .ml-insights {
            display: grid;
            gap: var(--space-sm);
        }

        .ml-insight {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-xs) 0;
        }

        .ml-insight-icon {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .ml-insight-text {
            flex: 1;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .ml-confidence {
            font-size: 11px;
            color: var(--text-tertiary);
            font-variant-numeric: tabular-nums;
        }

        /* Input Area */
        .input-area {
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-default);
            padding: var(--space-md) var(--space-lg);
        }

        .input-wrapper {
            background: var(--bg-elevated);
            border: 1px solid var(--border-default);
            border-radius: 8px;
            display: flex;
            align-items: flex-end;
            padding: var(--space-sm);
            transition: all var(--transition-fast);
        }

        .input-wrapper:focus-within {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
        }

        .input-field {
            flex: 1;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 13px;
            line-height: 1.5;
            padding: var(--space-xs) var(--space-sm);
            resize: none;
            outline: none;
            max-height: 120px;
            font-family: inherit;
        }

        .input-field::placeholder {
            color: var(--text-quaternary);
        }

        .input-actions {
            display: flex;
            gap: var(--space-xs);
            padding: 0 var(--space-xs);
        }

        .input-button {
            width: 32px;
            height: 32px;
            background: var(--bg-interactive);
            border: 1px solid var(--border-default);
            border-radius: 6px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .input-button:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
            border-color: var(--border-strong);
        }

        .send-button {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
            padding: 0 var(--space-md);
            width: auto;
            font-size: 12px;
            font-weight: 500;
        }

        /* Information Sidebar */
        .info-sidebar {
            background: var(--bg-secondary);
            overflow-y: auto;
            padding: var(--space-lg);
        }

        .info-section {
            margin-bottom: var(--space-xl);
        }

        .info-section-title {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-tertiary);
            margin-bottom: var(--space-md);
            letter-spacing: 0.05em;
        }

        .participant-list {
            display: grid;
            gap: var(--space-sm);
        }

        .participant {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm);
            background: var(--bg-elevated);
            border: 1px solid var(--border-default);
            border-radius: 6px;
            transition: all var(--transition-fast);
        }

        .participant:hover {
            background: var(--bg-hover);
            border-color: var(--border-strong);
        }

        .participant-avatar {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            background: var(--bg-interactive);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            position: relative;
        }

        .participant-status {
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            border: 2px solid var(--bg-elevated);
        }

        .status-online { background: var(--accent-success); }
        .status-busy { background: var(--accent-warning); }
        .status-offline { background: var(--text-quaternary); }

        .participant-info {
            flex: 1;
            min-width: 0;
        }

        .participant-name {
            font-weight: 500;
            font-size: 12px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .participant-role {
            font-size: 11px;
            color: var(--text-tertiary);
        }

        /* Timeline */
        .timeline-section {
            background: var(--bg-elevated);
            border: 1px solid var(--border-default);
            border-radius: 8px;
            padding: var(--space-md);
        }

        .timeline-item {
            display: flex;
            gap: var(--space-sm);
            padding: var(--space-sm) 0;
            position: relative;
        }

        .timeline-item:not(:last-child)::after {
            content: '';
            position: absolute;
            left: 15px;
            top: 28px;
            bottom: -8px;
            width: 1px;
            background: var(--border-default);
        }

        .timeline-marker {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-primary);
            margin-top: 4px;
            flex-shrink: 0;
        }

        .timeline-content {
            flex: 1;
            min-width: 0;
        }

        .timeline-event {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: var(--space-xs);
        }

        .timeline-time {
            font-size: 11px;
            color: var(--text-tertiary);
            font-variant-numeric: tabular-nums;
        }

        /* Footer Status Bar */
        .footer {
            grid-column: 1 / -1;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-default);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--space-lg);
        }

        .footer-left {
            display: flex;
            align-items: center;
            gap: var(--space-lg);
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-size: 11px;
            color: var(--text-tertiary);
        }

        .connection-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-success);
        }

        .footer-center {
            display: flex;
            gap: var(--space-sm);
        }

        .channel-control {
            padding: var(--space-xs) var(--space-md);
            background: var(--bg-elevated);
            border: 1px solid var(--border-default);
            border-radius: 6px;
            font-size: 11px;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .channel-control:hover {
            background: var(--bg-hover);
            border-color: var(--border-strong);
        }

        .channel-control.active {
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .footer-right {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .system-time {
            font-size: 11px;
            color: var(--text-tertiary);
            font-variant-numeric: tabular-nums;
        }

        /* Scrollbars */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--bg-interactive);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--bg-hover);
        }

        /* Loading States */
        .skeleton {
            background: linear-gradient(
                90deg,
                var(--bg-elevated) 0%,
                var(--bg-hover) 50%,
                var(--bg-elevated) 100%
            );
            background-size: 200% 100%;
            animation: skeleton 1.5s ease-in-out infinite;
        }

        @keyframes skeleton {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Tooltips */
        .tooltip {
            position: absolute;
            background: var(--bg-elevated);
            border: 1px solid var(--border-strong);
            border-radius: 6px;
            padding: var(--space-xs) var(--space-sm);
            font-size: 11px;
            color: var(--text-secondary);
            pointer-events: none;
            z-index: var(--z-notification);
            white-space: nowrap;
            opacity: 0;
            transition: opacity var(--transition-fast);
        }

        .tooltip.visible {
            opacity: 1;
        }

        /* Mobile Responsive */
        @media (max-width: 1280px) {
            .app-container {
                grid-template-columns: 60px 280px 1fr;
            }
            
            .info-sidebar {
                display: none;
            }
            
            .channel-name,
            .channel-status {
                display: none;
            }
            
            .channel-item {
                justify-content: center;
                padding: var(--space-sm);
            }
        }

        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
                grid-template-rows: 56px 1fr 64px;
            }
            
            .channel-sidebar,
            .message-list {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-brand">
                <div>
                    <div class="header-title">Communications Hub</div>
                    <div class="header-subtitle">Unified Omnichannel Platform</div>
                </div>
            </div>
            <div class="header-stats">
                <div class="stat-group">
                    <div class="stat-value">
                        <span id="activeChannels">12</span>
                        <span class="stat-indicator" style="background: var(--accent-success);"></span>
                    </div>
                    <div class="stat-label">Active Channels</div>
                </div>
                <div class="stat-group">
                    <div class="stat-value" style="color: var(--accent-danger);" id="criticalMessages">3</div>
                    <div class="stat-label">Critical</div>
                </div>
                <div class="stat-group">
                    <div class="stat-value" id="activeUsers">47</div>
                    <div class="stat-label">Online</div>
                </div>
                <div class="stat-group">
                    <div class="stat-value" id="responseTime">1.2s</div>
                    <div class="stat-label">Avg Response</div>
                </div>
            </div>
        </header>

        <!-- Channel Sidebar -->
        <aside class="channel-sidebar">
            <div class="channel-section">
                <div class="channel-section-header">
                    <div class="channel-section-title">Emergency Channels</div>
                </div>
                <div id="emergencyChannels"></div>
            </div>
            
            <div class="channel-section">
                <div class="channel-section-header">
                    <div class="channel-section-title">Team Channels</div>
                </div>
                <div id="teamChannels"></div>
            </div>
            
            <div class="channel-section">
                <div class="channel-section-header">
                    <div class="channel-section-title">Direct Messages</div>
                </div>
                <div id="directMessages"></div>
            </div>
        </aside>

        <!-- Message List -->
        <section class="message-list">
            <div class="message-list-header">
                <div class="message-filter">
                    <div class="filter-chip active" onclick="filterMessages('all')">All</div>
                    <div class="filter-chip" onclick="filterMessages('unread')">Unread</div>
                    <div class="filter-chip" onclick="filterMessages('priority')">Priority</div>
                    <div class="filter-chip" onclick="filterMessages('mentions')">Mentions</div>
                </div>
            </div>
            <div class="message-items" id="messageList"></div>
        </section>

        <!-- Main Communication Area -->
        <main class="communication-main">
            <div class="communication-header">
                <div class="communication-title">
                    <h2 id="currentChannelName">Emergency Response</h2>
                    <span style="color: var(--text-tertiary);">•</span>
                    <span style="color: var(--text-secondary); font-size: 12px;">All units monitoring</span>
                </div>
                <div class="communication-actions">
                    <button class="action-button" onclick="startVoiceCall()">
                        <span>🎙️</span> Voice
                    </button>
                    <button class="action-button" onclick="startVideoCall()">
                        <span>📹</span> Video
                    </button>
                    <button class="action-button" onclick="translateChannel()">
                        <span>🌐</span> Translate
                    </button>
                    <button class="action-button danger" onclick="escalateChannel()">
                        <span>⚠️</span> Escalate
                    </button>
                </div>
            </div>
            
            <div class="message-thread" id="messageThread"></div>
            
            <div class="input-area">
                <div class="input-wrapper">
                    <textarea 
                        class="input-field" 
                        id="messageInput"
                        placeholder="Type your message... (@ to mention, / for commands)"
                        rows="1"
                        onkeypress="handleKeyPress(event)"
                        oninput="autoResize(this)"
                    ></textarea>
                    <div class="input-actions">
                        <button class="input-button" onclick="attachFile()" title="Attach File">
                            <span>📎</span>
                        </button>
                        <button class="input-button" onclick="toggleVoiceInput()" title="Voice Input">
                            <span>🎤</span>
                        </button>
                        <button class="input-button" onclick="insertTemplate()" title="Templates">
                            <span>📝</span>
                        </button>
                        <button class="input-button send-button" onclick="sendMessage()">
                            Send
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Information Sidebar -->
        <aside class="info-sidebar">
            <div class="info-section">
                <div class="info-section-title">Participants</div>
                <div class="participant-list" id="participantList"></div>
            </div>
            
            <div class="info-section">
                <div class="info-section-title">ML Analysis</div>
                <div class="ml-panel">
                    <div class="ml-header">
                        <div class="ml-title">
                            <span class="ml-indicator"></span>
                            Real-time Insights
                        </div>
                    </div>
                    <div class="ml-insights" id="mlInsights"></div>
                </div>
            </div>
            
            <div class="info-section">
                <div class="info-section-title">Activity Timeline</div>
                <div class="timeline-section" id="activityTimeline"></div>
            </div>
        </aside>

        <!-- Footer Status Bar -->
        <footer class="footer">
            <div class="footer-left">
                <div class="connection-status">
                    <span class="connection-indicator"></span>
                    <span>Connected • WebSocket Active</span>
                </div>
                <div class="connection-status">
                    <span>Latency: 12ms</span>
                </div>
            </div>
            
            <div class="footer-center">
                <button class="channel-control active" onclick="toggleChannel('radio')">
                    <span>📻</span> Radio
                </button>
                <button class="channel-control" onclick="toggleChannel('phone')">
                    <span>📞</span> Phone
                </button>
                <button class="channel-control" onclick="toggleChannel('text')">
                    <span>💬</span> Text
                </button>
                <button class="channel-control" onclick="toggleChannel('email')">
                    <span>📧</span> Email
                </button>
            </div>
            
            <div class="footer-right">
                <div class="system-time" id="systemTime"></div>
            </div>
        </footer>
    </div>

    <script>
        // Enterprise Communication Hub Logic
        class CommunicationHub {
            constructor() {
                this.channels = this.generateChannels();
                this.messages = this.generateMessages();
                this.participants = this.generateParticipants();
                this.currentChannel = 'emergency-response';
                this.activeChannels = new Set(['radio', 'text']);
                this.mlAnalyzer = new MLAnalyzer();
                this.init();
            }

            init() {
                this.renderChannels();
                this.renderMessages();
                this.renderParticipants();
                this.renderThread();
                this.startRealtimeSimulation();
                this.updateSystemTime();
                setInterval(() => this.updateSystemTime(), 1000);
            }

            generateChannels() {
                return {
                    emergency: [
                        { id: 'emergency-response', name: 'Emergency Response', icon: '🚨', unread: 3, priority: 'critical' },
                        { id: 'medical-dispatch', name: 'Medical Dispatch', icon: '🏥', unread: 1, priority: 'high' },
                        { id: 'fire-coordination', name: 'Fire Coordination', icon: '🔥', unread: 0, priority: 'high' }
                    ],
                    team: [
                        { id: 'north-sector', name: 'North Sector', icon: '🏢', unread: 5, priority: 'medium' },
                        { id: 'south-sector', name: 'South Sector', icon: '🏢', unread: 2, priority: 'medium' },
                        { id: 'patrol-units', name: 'Patrol Units', icon: '🚓', unread: 8, priority: 'low' },
                        { id: 'control-room', name: 'Control Room', icon: '🖥️', unread: 0, priority: 'low' }
                    ],
                    direct: [
                        { id: 'garcia-m', name: 'Garcia, M.', role: 'Supervisor', status: 'online', unread: 0 },
                        { id: 'chen-l', name: 'Chen, L.', role: 'K9 Unit', status: 'online', unread: 2 },
                        { id: 'davis-k', name: 'Davis, K.', role: 'Patrol', status: 'busy', unread: 0 },
                        { id: 'wilson-r', name: 'Wilson, R.', role: 'Control', status: 'offline', unread: 1 }
                    ]
                };
            }

            generateMessages() {
                const messages = [];
                const senders = ['Control', 'Garcia, M.', 'Chen, L.', 'Davis, K.', 'Wilson, R.', 'System'];
                const channels = ['radio', 'phone', 'text', 'email'];
                const priorities = ['critical', 'high', 'medium', 'low'];
                
                for (let i = 0; i < 50; i++) {
                    const timestamp = new Date(Date.now() - Math.random() * 3600000);
                    const priority = priorities[Math.floor(Math.random() * priorities.length)];
                    
                    messages.push({
                        id: `msg-${i}`,
                        sender: senders[Math.floor(Math.random() * senders.length)],
                        channel: channels[Math.floor(Math.random() * channels.length)],
                        priority,
                        timestamp,
                        preview: this.generateMessagePreview(priority),
                        unread: Math.random() > 0.6,
                        attachments: Math.random() > 0.8 ? ['image.jpg', 'report.pdf'] : [],
                        translated: false,
                        mlTags: this.generateMLTags(priority)
                    });
                }
                
                return messages.sort((a, b) => b.timestamp - a.timestamp);
            }

            generateMessagePreview(priority) {
                const previews = {
                    critical: [
                        'Code Red: Unauthorized breach detected in Sector 7',
                        'EMERGENCY: Multiple alarms triggered in Building A',
                        'CRITICAL: Suspect fleeing scene, all units respond'
                    ],
                    high: [
                        'Suspicious activity reported near loading dock',
                        'Medical assistance required at North Gate',
                        'Vehicle pursuit in progress on perimeter road'
                    ],
                    medium: [
                        'Routine patrol completed, all clear in Zone B',
                        'Visitor badge expired, please verify at checkpoint',
                        'Maintenance crew requesting access to restricted area'
                    ],
                    low: [
                        'Shift change briefing at 14:00 hours',
                        'Weather advisory: Heavy rain expected',
                        'System test scheduled for tomorrow morning'
                    ]
                };
                
                const options = previews[priority];
                return options[Math.floor(Math.random() * options.length)];
            }

            generateMLTags(priority) {
                const tags = [];
                if (priority === 'critical') tags.push({ type: 'threat', confidence: 0.92 });
                if (Math.random() > 0.7) tags.push({ type: 'anomaly', confidence: 0.78 });
                if (Math.random() > 0.8) tags.push({ type: 'pattern', confidence: 0.65 });
                return tags;
            }

            generateParticipants() {
                return [
                    { id: 'garcia-m', name: 'Garcia, M.', role: 'Supervisor', status: 'online', avatar: 'GM' },
                    { id: 'chen-l', name: 'Chen, L.', role: 'K9 Unit', status: 'online', avatar: 'CL' },
                    { id: 'davis-k', name: 'Davis, K.', role: 'Patrol', status: 'busy', avatar: 'DK' },
                    { id: 'wilson-r', name: 'Wilson, R.', role: 'Control', status: 'offline', avatar: 'WR' },
                    { id: 'johnson-a', name: 'Johnson, A.', role: 'Dispatch', status: 'online', avatar: 'JA' },
                    { id: 'smith-t', name: 'Smith, T.', role: 'Medical', status: 'online', avatar: 'ST' }
                ];
            }

            renderChannels() {
                // Emergency Channels
                const emergencyHtml = this.channels.emergency.map(channel => `
                    <div class="channel-item ${channel.id === this.currentChannel ? 'active' : ''}" 
                         onclick="hub.switchChannel('${channel.id}')">
                        <div class="channel-icon">${channel.icon}</div>
                        <div class="channel-info">
                            <div class="channel-name">${channel.name}</div>
                            <div class="channel-status">Priority: ${channel.priority}</div>
                        </div>
                        ${channel.unread > 0 ? `<span class="channel-badge">${channel.unread}</span>` : ''}
                    </div>
                `).join('');
                document.getElementById('emergencyChannels').innerHTML = emergencyHtml;

                // Team Channels
                const teamHtml = this.channels.team.map(channel => `
                    <div class="channel-item ${channel.id === this.currentChannel ? 'active' : ''}" 
                         onclick="hub.switchChannel('${channel.id}')">
                        <div class="channel-icon">${channel.icon}</div>
                        <div class="channel-info">
                            <div class="channel-name">${channel.name}</div>
                            <div class="channel-status">Active members: ${Math.floor(Math.random() * 20 + 5)}</div>
                        </div>
                        ${channel.unread > 0 ? `<span class="channel-badge">${channel.unread}</span>` : ''}
                    </div>
                `).join('');
                document.getElementById('teamChannels').innerHTML = teamHtml;

                // Direct Messages
                const dmHtml = this.channels.direct.map(dm => `
                    <div class="channel-item" onclick="hub.switchChannel('${dm.id}')">
                        <div class="channel-icon">${dm.name.split(',')[0][0]}${dm.name.split(' ')[1][0]}</div>
                        <div class="channel-info">
                            <div class="channel-name">${dm.name}</div>
                            <div class="channel-status">${dm.role} • ${dm.status}</div>
                        </div>
                        ${dm.unread > 0 ? `<span class="channel-badge">${dm.unread}</span>` : ''}
                    </div>
                `).join('');
                document.getElementById('directMessages').innerHTML = dmHtml;
            }

            renderMessages() {
                const messageHtml = this.messages.slice(0, 20).map(msg => `
                    <div class="message-item ${msg.unread ? 'unread' : ''}" onclick="hub.selectMessage('${msg.id}')">
                        <div class="message-priority ${msg.priority}"></div>
                        <div class="message-header">
                            <div class="message-sender">
                                <span class="message-channel-badge" style="background: var(--channel-${msg.channel});">
                                    ${this.getChannelIcon(msg.channel)}
                                </span>
                                ${msg.sender}
                            </div>
                            <div class="message-time">${this.formatTime(msg.timestamp)}</div>
                        </div>
                        <div class="message-preview">${msg.preview}</div>
                        <div class="message-metadata">
                            ${msg.attachments.length > 0 ? `
                                <div class="message-tag">📎 ${msg.attachments.length} files</div>
                            ` : ''}
                            ${msg.mlTags.map(tag => `
                                <div class="message-tag">
                                    🤖 ${tag.type} (${Math.round(tag.confidence * 100)}%)
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
                
                document.getElementById('messageList').innerHTML = messageHtml;
            }

            renderThread() {
                const threadMessages = [
                    {
                        sender: 'Control',
                        avatar: 'CO',
                        time: new Date(Date.now() - 300000),
                        text: 'All units, we have a Code 3 situation at Building Alpha, North entrance. Suspect description: Male, approximately 6ft, wearing dark clothing.',
                        attachments: ['security_cam_screenshot.jpg'],
                        mlAnalysis: {
                            sentiment: 'urgent',
                            entities: ['Building Alpha', 'North entrance'],
                            threatLevel: 0.85
                        }
                    },
                    {
                        sender: 'Garcia, M.',
                        avatar: 'GM',
                        time: new Date(Date.now() - 240000),
                        text: 'Unit 1 responding, ETA 2 minutes. Approaching from west side.',
                        mlAnalysis: {
                            sentiment: 'responsive',
                            intent: 'acknowledgment',
                            confidence: 0.92
                        }
                    },
                    {
                        sender: 'Chen, L.',
                        avatar: 'CL',
                        time: new Date(Date.now() - 180000),
                        text: 'K9 unit en route to assist. Can we get eyes on all exits?',
                        mlAnalysis: {
                            sentiment: 'collaborative',
                            request: 'surveillance',
                            priority: 'high'
                        }
                    },
                    {
                        sender: 'System',
                        avatar: '🤖',
                        time: new Date(Date.now() - 120000),
                        text: 'ML ALERT: Anomaly detected in movement patterns. 87% match with previous intrusion attempt on 2024-01-15. Recommended action: Increase perimeter surveillance.',
                        isSystem: true,
                        mlAnalysis: {
                            type: 'pattern_recognition',
                            confidence: 0.87,
                            recommendation: 'increase_surveillance'
                        }
                    }
                ];

                const threadHtml = threadMessages.map(msg => `
                    <div class="thread-message">
                        <div class="thread-avatar ${msg.isSystem ? 'system' : ''}">${msg.avatar}</div>
                        <div class="thread-content">
                            <div class="thread-header">
                                <div class="thread-sender">${msg.sender}</div>
                                <div class="thread-time">${this.formatTime(msg.time)}</div>
                            </div>
                            <div class="thread-body">
                                <div class="thread-text">${msg.text}</div>
                                ${msg.attachments ? `
                                    <div class="thread-attachments">
                                        ${msg.attachments.map(file => `
                                            <div class="attachment">
                                                <span>📄</span>
                                                <span>${file}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                ` : ''}
                                ${msg.mlAnalysis ? `
                                    <div class="ml-panel" style="margin-top: 12px;">
                                        <div class="ml-header">
                                            <div class="ml-title">
                                                <span class="ml-indicator"></span>
                                                ML Analysis
                                            </div>
                                        </div>
                                        <div class="ml-insights">
                                            ${Object.entries(msg.mlAnalysis).map(([key, value]) => `
                                                <div class="ml-insight">
                                                    <div class="ml-insight-icon" style="background: var(--bg-interactive);">
                                                        ${this.getMLIcon(key)}
                                                    </div>
                                                    <div class="ml-insight-text">${key}: ${value}</div>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `).join('');

                document.getElementById('messageThread').innerHTML = threadHtml;
            }

            renderParticipants() {
                const participantHtml = this.participants.map(p => `
                    <div class="participant">
                        <div class="participant-avatar">
                            ${p.avatar}
                            <div class="participant-status status-${p.status}"></div>
                        </div>
                        <div class="participant-info">
                            <div class="participant-name">${p.name}</div>
                            <div class="participant-role">${p.role}</div>
                        </div>
                    </div>
                `).join('');
                
                document.getElementById('participantList').innerHTML = participantHtml;
            }

            getChannelIcon(channel) {
                const icons = {
                    radio: '📻',
                    phone: '📞',
                    text: '💬',
                    email: '📧'
                };
                return icons[channel] || '📡';
            }

            getMLIcon(key) {
                const icons = {
                    sentiment: '😊',
                    entities: '🏷️',
                    threatLevel: '⚠️',
                    intent: '🎯',
                    confidence: '📊',
                    type: '🔍',
                    recommendation: '💡'
                };
                return icons[key] || '🤖';
            }

            formatTime(date) {
                const now = new Date();
                const diff = now - date;
                const minutes = Math.floor(diff / 60000);
                
                if (minutes < 1) return 'Now';
                if (minutes < 60) return `${minutes}m ago`;
                if (minutes < 1440) return `${Math.floor(minutes / 60)}h ago`;
                
                return date.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: false 
                });
            }

            switchChannel(channelId) {
                this.currentChannel = channelId;
                this.renderChannels();
                // Update channel name
                const allChannels = [...this.channels.emergency, ...this.channels.team, ...this.channels.direct];
                const channel = allChannels.find(c => c.id === channelId);
                if (channel) {
                    document.getElementById('currentChannelName').textContent = channel.name;
                }
                // Re-render thread with channel-specific messages
                this.renderThread();
            }

            selectMessage(messageId) {
                console.log('Selected message:', messageId);
                // In real app, would load full message thread
            }

            startRealtimeSimulation() {
                // Simulate new messages
                setInterval(() => {
                    if (Math.random() > 0.7) {
                        const newMessage = this.generateMessages()[0];
                        this.messages.unshift(newMessage);
                        this.renderMessages();
                        
                        // Update stats
                        const criticalCount = this.messages.filter(m => m.priority === 'critical' && m.unread).length;
                        document.getElementById('criticalMessages').textContent = criticalCount;
                    }
                }, 5000);

                // Update response time
                setInterval(() => {
                    const responseTime = (Math.random() * 2 + 0.5).toFixed(1);
                    document.getElementById('responseTime').textContent = `${responseTime}s`;
                }, 10000);

                // ML Insights updates
                this.updateMLInsights();
                setInterval(() => this.updateMLInsights(), 15000);

                // Activity timeline updates
                this.updateActivityTimeline();
                setInterval(() => this.updateActivityTimeline(), 30000);
            }

            updateMLInsights() {
                const insights = [
                    { icon: '🔍', text: 'Threat pattern detected in Sector 7', confidence: 0.89 },
                    { icon: '📈', text: 'Communication volume up 23%', confidence: 0.95 },
                    { icon: '🌐', text: '3 messages auto-translated', confidence: 1.0 },
                    { icon: '⚡', text: 'Response time improved by 18%', confidence: 0.92 },
                    { icon: '🔔', text: 'Unusual activity in Building C', confidence: 0.76 }
                ];

                const insightsHtml = insights.slice(0, 4).map(insight => `
                    <div class="ml-insight">
                        <div class="ml-insight-icon" style="background: var(--bg-interactive);">
                            ${insight.icon}
                        </div>
                        <div class="ml-insight-text">${insight.text}</div>
                        <div class="ml-confidence">${Math.round(insight.confidence * 100)}%</div>
                    </div>
                `).join('');

                document.getElementById('mlInsights').innerHTML = insightsHtml;
            }

            updateActivityTimeline() {
                const events = [
                    { event: 'Emergency channel activated', time: new Date(Date.now() - 180000) },
                    { event: 'All units notified', time: new Date(Date.now() - 170000) },
                    { event: 'First responder on scene', time: new Date(Date.now() - 120000) },
                    { event: 'Situation contained', time: new Date(Date.now() - 60000) },
                    { event: 'Debriefing scheduled', time: new Date(Date.now() - 30000) }
                ];

                const timelineHtml = events.map((event, index) => `
                    <div class="timeline-item">
                        <div class="timeline-marker"></div>
                        <div class="timeline-content">
                            <div class="timeline-event">${event.event}</div>
                            <div class="timeline-time">${this.formatTime(event.time)}</div>
                        </div>
                    </div>
                `).join('');

                document.getElementById('activityTimeline').innerHTML = timelineHtml;
            }

            updateSystemTime() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('en-US', { 
                    hour12: false,
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                const dateString = now.toLocaleDateString('en-US', {
                    weekday: 'short',
                    month: 'short',
                    day: 'numeric'
                });
                document.getElementById('systemTime').textContent = `${dateString} ${timeString}`;
            }
        }

        // ML Analyzer Class
        class MLAnalyzer {
            constructor() {
                this.models = {
                    sentiment: { loaded: true, accuracy: 0.94 },
                    threat: { loaded: true, accuracy: 0.89 },
                    translation: { loaded: true, languages: ['en', 'es', 'fr', 'ar', 'zh'] },
                    pattern: { loaded: true, accuracy: 0.91 }
                };
            }

            analyzeMessage(text) {
                // Simulated ML analysis
                return {
                    sentiment: this.analyzeSentiment(text),
                    threat: this.analyzeThreat(text),
                    entities: this.extractEntities(text),
                    suggestedActions: this.suggestActions(text)
                };
            }

            analyzeSentiment(text) {
                const keywords = {
                    urgent: ['emergency', 'critical', 'immediate', 'urgent'],
                    negative: ['threat', 'danger', 'suspicious', 'breach'],
                    positive: ['clear', 'secure', 'resolved', 'contained']
                };
                
                for (const [sentiment, words] of Object.entries(keywords)) {
                    if (words.some(word => text.toLowerCase().includes(word))) {
                        return sentiment;
                    }
                }
                return 'neutral';
            }

            analyzeThreat(text) {
                const threatKeywords = ['breach', 'unauthorized', 'suspect', 'weapon', 'explosive'];
                const matches = threatKeywords.filter(keyword => 
                    text.toLowerCase().includes(keyword)
                ).length;
                return Math.min(matches * 0.25, 1.0);
            }

            extractEntities(text) {
                // Simple entity extraction simulation
                const patterns = {
                    locations: /Building [A-Z]|Sector \d+|Gate|Zone [A-Z]-\d+/g,
                    people: /[A-Z][a-z]+, [A-Z]\.|Unit \d+/g,
                    times: /\d{1,2}:\d{2}|\d+ minutes?|\d+ hours?/g
                };
                
                const entities = [];
                for (const [type, pattern] of Object.entries(patterns)) {
                    const matches = text.match(pattern);
                    if (matches) {
                        entities.push(...matches.map(match => ({ type, value: match })));
                    }
                }
                return entities;
            }

            suggestActions(text) {
                const suggestions = [];
                if (text.toLowerCase().includes('emergency')) {
                    suggestions.push('Escalate to supervisor');
                }
                if (text.toLowerCase().includes('medical')) {
                    suggestions.push('Dispatch medical team');
                }
                if (text.toLowerCase().includes('backup')) {
                    suggestions.push('Send nearest available units');
                }
                return suggestions;
            }
        }

        // Global instance
        const hub = new CommunicationHub();

        // UI Functions
        function filterMessages(filter) {
            document.querySelectorAll('.filter-chip').forEach(chip => {
                chip.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // In real app, would filter message list
            console.log('Filtering messages by:', filter);
        }

        function toggleChannel(channel) {
            const control = event.target;
            control.classList.toggle('active');
            
            if (control.classList.contains('active')) {
                hub.activeChannels.add(channel);
            } else {
                hub.activeChannels.delete(channel);
            }
            
            console.log('Active channels:', Array.from(hub.activeChannels));
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (text) {
                // Analyze message with ML
                const analysis = hub.mlAnalyzer.analyzeMessage(text);
                console.log('Message analysis:', analysis);
                
                // Add to thread
                const newMessage = {
                    sender: 'You',
                    avatar: 'ME',
                    time: new Date(),
                    text: text,
                    mlAnalysis: analysis
                };
                
                // Clear input
                input.value = '';
                autoResize(input);
                
                // Simulate sending
                setTimeout(() => {
                    hub.renderThread();
                }, 100);
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }

        // Action handlers
        function startVoiceCall() {
            console.log('Starting voice call...');
        }

        function startVideoCall() {
            console.log('Starting video call...');
        }

        function translateChannel() {
            console.log('Translating channel messages...');
        }

        function escalateChannel() {
            console.log('Escalating to emergency status...');
        }

        function attachFile() {
            console.log('Attaching file...');
        }

        function toggleVoiceInput() {
            console.log('Toggling voice input...');
        }

        function insertTemplate() {
            console.log('Inserting template...');
        }
    </script>
</body>
</html>